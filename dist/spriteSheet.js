!function(t){t.animation=function(i){var e=Object.create(t.animation.prototype);return e._init(i),e},t.animation.prototype={_init:function(t){t=t||{},this.spriteSheet=t.spriteSheet,this.frames=t.frames,this.frameRate=t.frameRate;var i=t.spriteSheet.frame;this.width=i.width,this.height=i.height,this.margin=i.margin||0,this._frame=0,this._accum=0},clone:function(){return t.animation(this)},update:function(t){for(t=t||1/60,this._accum+=t;this._accum*this.frameRate>=1;)this._frame=++this._frame%this.frames.length,this._accum-=1/this.frameRate},render:function(i){i=i||{};var e=i.context||t.context,r=this.frames[this._frame]/this.spriteSheet.framesPerRow|0,a=this.frames[this._frame]%this.spriteSheet.framesPerRow|0;e.drawImage(this.spriteSheet.image,a*this.width+(2*a+1)*this.margin,r*this.height+(2*r+1)*this.margin,this.width,this.height,i.x,i.y,this.width,this.height)}},t.spriteSheet=function(i){var e=Object.create(t.spriteSheet.prototype);return e._init(i),e},t.spriteSheet.prototype={_init:function(i){if(i=i||{},!t._isImage(i.image))throw Erorr("You must provide an Image for the SpriteSheet");this.animations={},this.image=i.image,this.frame={width:i.frameWidth,height:i.frameHeight,margin:i.frameMargin},this.framesPerRow=i.image.width/i.frameWidth|0,this.createAnimations(i.animations)},createAnimations:function(i){var e,r,a,h;for(var s in i){if(e=i[s],r=e.frames,a=e.frameRate,h=[],void 0===r)throw Error("Animation "+s+" must provide a frames property");Array.isArray(r)||(r=[r]);for(var n,m=0;n=r[m];m++)h.push.apply(h,this._parse(n));this.animations[s]=t.animation({spriteSheet:this,frames:h,frameRate:a})}},_parse:function(e){if(t._isNumber(e))return[e];var r=[],a=e.split(".."),h=i=+a[0],s=+a[1];if(h<s)for(;i<=s;i++)r.push(i);else for(;i>=s;i--)r.push(i);return r}}}(kontra);